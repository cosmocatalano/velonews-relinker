function clearEnd(a,b,c=1){let d=!1;return d=a[a.length-c]===b?clearEnd(a,b,c+1):a.substr(0,a.length-(c-1)),d}const competitorUrl=/velonews\.competitor\.com\/20[0-9]{2}\//g,liveUrl=/velonews\.com\/(tick|live)\//g,competitorImg=/competitor\.com\/(.*?).jpg/g,veryoldImg=/velonews\.com(\S*?).(f|preview).jpg/g,veryoldUrl=/velonews\.com\/(.*?)\.htm/g,noslugUrl=/articles\/[0-9]+$/g,competitorBase="velonews.competitor.com",vnBase="https://velonews.com?p=",domainBase="https://velonews.com",wbBase="https://web.archive.org/web/2000/";let postId="";const changedUrls=new Map;document.addEventListener("DOMContentLoaded",function(){let a=document.querySelectorAll("a");for(let b of a){let a=clearEnd(b.href),c=new URL(a);if("velonews.competitor.com"===c.hostname||"www.velonews.com"===c.hostname||"velonews.com"===c.hostname){if(!c.search&&"/"===c.pathname){changedUrls.set(b.href,domainBase),b.href="https://velonews.com";continue}if("velonews.competitor.com"===c.hostname)if(c.href.match(competitorUrl)){changedUrls.set(b.href,domainBase+b.pathname),b.href=domainBase+b.pathname;continue}else{changedUrls.set(b.href,wbBase+b.href),b.href=wbBase+b.href;continue}if(c.href.match(liveUrl)||c.href.match(veryoldImg)){changedUrls.set(b.href,wbBase+b.href),b.href=wbBase+b.href;continue}if(c.href.match(veryoldUrl)){postId=b.pathname.split("/")[b.pathname.split("/").length-1],changedUrls.set(b.href,vnBase+postId),b.href=vnBase+postId;continue}if(c.pathname.match(noslugUrl)){postId=b.pathname.split("/")[b.pathname.split("/").length-1],changedUrls.set(b.href,vnBase+postId),b.href=vnBase+postId;continue}changedUrls.set(b.href,b.href)}}console.log("velonews-relinker found "+changedUrls.size+" urls:");for(let a of changedUrls)a[0]===a[1]?console.log("did not update likely-working "+a[0]):console.log("updated "+a[0]+" to "+a[1]);console.log("more info: https://github.com/cosmocatalano/velonews-relinker")});